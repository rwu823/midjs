!function(n){"object"==typeof module&&"object"==typeof module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):this.Mid=n()}(function(){function n(n,t){return e.call(n,t)}var e=Array.prototype.slice,t="function"==typeof setImmediate?setImmediate:function(n){setTimeout(n,0)},o=function(){function e(e){var o=this;if(!/^a?sync$/.test(e))throw new Error('[Mid.js] \n	invalid type: "'+e+'"\n	require type: "sync" or "async"');return o.type=e,o._useFns=[],o._doneFns=[],o._onceFn=null,t(function(){var t=o._doneFns.shift(),i=o._useFns.length;({async:function(){for(var n,e=function(){if(i-=1,t&&t(i),0===i){o._onceFn&&o._onceFn();for(var n,e=0;n=o._doneFns[e];e++)n()}},u=0;n=o._useFns[u];u++)n(e)},sync:function(){function e(o){var i=function(){var u=n(arguments);o[e.idx]?(u.push(i),o[e.idx].apply(null,u),e.idx+=1):t&&t()};e.idx=0,i()}e(o._useFns)}})[e]()}),o}function o(n){return new e(n)}var i=e.prototype;return i.use=function(n){return this._useFns.push(n),this},i.done=function(n){return this._doneFns.push(n),this},i.once=function(n){return this._onceFn=n,this},o}();return o});